<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forgot Password - GTW Game</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="forgot-password-styles.css">
</head>
<body>
    <div class="forgot-password-container">
        <div class="forgot-password-card">
            <div class="lock-icon">üîí</div>
            <h1>Forgot Password</h1>
            <p class="subtitle">Enter your registered email address to receive OTP</p>
            
            <form id="forgotPasswordForm">
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        placeholder="Enter your registered email"
                        required
                    >
                </div>
                
                <button type="submit" class="send-otp-btn" id="sendOtpBtn">
                    Send OTP
                </button>
            </form>
            
            <!-- OTP Input Section (Initially Hidden) -->
            <div class="otp-section" id="otpSection" style="display: none;">
                <div class="form-group">
                    <label for="otp">Enter OTP</label>
                    <div class="otp-input-group">
                        <input type="text" maxlength="1" class="otp-input" required>
                        <input type="text" maxlength="1" class="otp-input" required>
                        <input type="text" maxlength="1" class="otp-input" required>
                        <input type="text" maxlength="1" class="otp-input" required>
                        <input type="text" maxlength="1" class="otp-input" required>
                        <input type="text" maxlength="1" class="otp-input" required>
                    </div>
                    <p class="otp-timer" id="otpTimer"></p>
                    <button type="button" class="resend-otp-btn" id="resendOtpBtn" disabled>
                        Resend OTP
                    </button>
                </div>
            </div>

            <div class="message" id="message"></div>
            
            <a href="user-login.html" class="back-to-login">‚Üê Back to Login</a>
        </div>
    </div>

    <script>
        document.getElementById('forgotPasswordForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const email = document.getElementById('email').value.trim();
            const sendOtpBtn = document.getElementById('sendOtpBtn');
            const message = document.getElementById('message');
            
            if (!email) {
                showMessage('Please enter your email address', 'error');
                return;
            }

            // Show loading state
            sendOtpBtn.textContent = 'Sending...';
            sendOtpBtn.disabled = true;

            try {
                // Simulate API call (replace with actual API call)
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // Show OTP section
                document.getElementById('otpSection').style.display = 'block';
                showMessage('OTP has been sent to your email', 'success');
                
                // Start timer
                startOtpTimer();
                
            } catch (error) {
                showMessage(error.message || 'Failed to send OTP. Please try again.', 'error');
            } finally {
                sendOtpBtn.textContent = 'Send OTP';
                sendOtpBtn.disabled = false;
            }
        });

        // OTP Input Handling
        const otpInputs = document.querySelectorAll('.otp-input');
        otpInputs.forEach((input, index) => {
            input.addEventListener('input', function() {
                if (this.value.length === 1) {
                    if (index < otpInputs.length - 1) {
                        otpInputs[index + 1].focus();
                    }
                }
            });

            input.addEventListener('keydown', function(e) {
                if (e.key === 'Backspace' && !this.value) {
                    if (index > 0) {
                        otpInputs[index - 1].focus();
                    }
                }
            });
        });

        function startOtpTimer() {
            let timeLeft = 30;
            const timerElement = document.getElementById('otpTimer');
            const resendButton = document.getElementById('resendOtpBtn');
            
            const timer = setInterval(() => {
                timeLeft--;
                timerElement.textContent = `Resend OTP in ${timeLeft}s`;
                
                if (timeLeft === 0) {
                    clearInterval(timer);
                    timerElement.textContent = '';
                    resendButton.disabled = false;
                }
            }, 1000);
        }

        document.getElementById('resendOtpBtn').addEventListener('click', function() {
            this.disabled = true;
            startOtpTimer();
            showMessage('OTP has been resent to your email', 'success');
        });

        function showMessage(text, type) {
            const message = document.getElementById('message');
            message.textContent = text;
            message.className = 'message ' + type;
            message.style.display = 'block';
            
            setTimeout(() => {
                message.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>